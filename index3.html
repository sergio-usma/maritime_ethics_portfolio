<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Módulo de Aprendizaje: Ética Marítima</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    
    <style>
        :root {
            --primary: #1a365d;
            --secondary: #2b6cb0;
            --accent: #ed8936;
            --bg-light: #f8f9fa;
            --text-dark: #2d3748;
            --success: #38a169;
            --danger: #e53e3e;
        }

        body {
            background-color: var(--bg-light);
            color: var(--text-dark);
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .navbar-custom { background-color: var(--primary); color: white; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }

        /* Estilos de Lectura y Checks */
        .read-status-icon {
            font-size: 1.2rem;
            margin-right: 10px;
            transition: all 0.3s ease;
        }
        .status-pending { color: #cbd5e0; }
        .status-completed { color: var(--success); }
        .accordion-button:not(.collapsed) { background-color: #ebf8ff; color: var(--primary); }

        /* Flashcards */
        .flashcard-container { perspective: 1000px; width: 100%; max-width: 600px; height: 300px; margin: 0 auto; cursor: pointer; }
        .card-flip { width: 100%; height: 100%; position: relative; transition: transform 0.6s; transform-style: preserve-3d; }
        .card-flip.is-flipped { transform: rotateY(180deg); }
        .card-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; align-items: center; justify-content: center; padding: 2rem; text-align: center; border-radius: 12px; font-size: 1.25rem; }
        .card-front { background: white; color: var(--primary); border: 2px solid var(--secondary); }
        .card-back { background: var(--secondary); color: white; transform: rotateY(180deg); overflow-y: auto; }

        /* Quiz */
        .quiz-option { width: 100%; text-align: left; margin-bottom: 0.75rem; padding: 1rem; border: 2px solid #e2e8f0; background: white; border-radius: 8px; }
        .quiz-option.correct { background: #f0fff4; border-color: var(--success); }
        .quiz-option.incorrect { background: #fff5f5; border-color: var(--danger); }
        .explanation-box { display: none; background: #ebf8ff; border-left: 4px solid var(--secondary); padding: 1rem; margin-top: 1rem; }

        .progress-custom { height: 12px; border-radius: 6px; background: #cbd5e0; }
        .progress-bar-custom { background: var(--accent); transition: width 0.5s; }

        /* Estilos para resumen */
        .summary-item {
            background-color: white;
            border: 1px solid #e2e8f0;
            border-left: 4px solid var(--secondary);
            border-radius: 8px;
            padding: 1.2rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.02);
            transition: all 0.2s;
        }
        .summary-item:hover {
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            border-left-width: 6px;
        }

        footer { background: var(--primary); color: #cbd5e0; text-align: center; padding: 1.5rem 0; margin-top: auto; }
    </style>
</head>
<body>

    <nav class="navbar navbar-custom py-3">
        <div class="container d-flex justify-content-between align-items-center">
            <div class="d-flex align-items-center">
                <i class="bi bi-shield-check fs-2 me-3 text-warning"></i>
                <h1 class="h4 mb-0" id="course-title">Ética Marítima · Liderazgo y Seguridad</h1>
            </div>
            <span class="badge bg-warning text-dark fs-6 rounded-pill px-3 py-2" id="progress-badge">0% Completado</span>
        </div>
    </nav>

    <main class="container my-5">
        <div class="mb-5">
            <div class="d-flex justify-content-between mb-2">
                <span class="fw-bold text-muted"><i class="bi bi-bar-chart-fill me-1"></i> Progreso del Módulo Completo</span>
                <span class="fw-bold" id="progress-text">0/0</span>
            </div>
            <div class="progress progress-custom">
                <div class="progress-bar progress-bar-custom" id="global-progress" role="progressbar" style="width: 0%"></div>
            </div>
        </div>

        <ul class="nav nav-tabs mb-4" id="studyTabs" role="tablist">
            <li class="nav-item"><button class="nav-link active fw-bold" data-bs-toggle="tab" data-bs-target="#lectures-pane"><i class="bi bi-book me-1"></i> Lecturas</button></li>
            <li class="nav-item"><button class="nav-link fw-bold" data-bs-toggle="tab" data-bs-target="#flashcards"><i class="bi bi-card-text me-1"></i> Flashcards</button></li>
            <li class="nav-item"><button class="nav-link fw-bold" data-bs-toggle="tab" data-bs-target="#quiz"><i class="bi bi-ui-checks me-1"></i> Quiz</button></li>
            <li class="nav-item"><button class="nav-link fw-bold" data-bs-toggle="tab" data-bs-target="#summary"><i class="bi bi-list-check me-1"></i> Resumen</button></li>
        </ul>

        <div class="tab-content pt-3">
            <!-- PESTAÑA DE LECTURAS (acordeón con las 3 clases) -->
            <div class="tab-pane fade show active" id="lectures-pane">
                <div class="accordion" id="lecturesAccordion">
                    <!-- Lecture 01: Fundamentos Filosóficos -->
                    <div class="accordion-item shadow-sm mb-3 border-0">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#l1" onclick="markAsRead(0)">
                                <i id="icon-l0" class="bi bi-circle read-status-icon status-pending"></i> Lecture 01: Ética Profesional Marítima – Fundamentos
                            </button>
                        </h2>
                        <div id="l1" class="accordion-collapse collapse" data-bs-parent="#lecturesAccordion">
                            <div class="accordion-body">
                                <h5 class="text-primary">Ética vs. Moral</h5>
                                <p><strong>Ética:</strong> reflexión racional universal; <strong>Moral:</strong> costumbres locales. En el mar, la ética permite navegar zonas grises donde la ley no es explícita.</p>
                                <h5 class="text-primary mt-3">Formación del carácter</h5>
                                <p><em>Habituación reflexiva:</em> repetición consciente de actos éticos (familia → escuela → profesión). El carácter se forja, no es innato.</p>
                                <h5 class="text-primary mt-3">Herramientas clave</h5>
                                <ul>
                                    <li><strong>Inteligencia emocional:</strong> autocontrol bajo presión.</li>
                                    <li><strong>Inteligencia cultural:</strong> respeto por la diversidad sin ceder en principios.</li>
                                    <li><strong>Corrupción sistémica:</strong> no solo soborno, también negligencia y ausentismo.</li>
                                </ul>
                                <h5 class="text-primary mt-3">Casos analizados</h5>
                                <ul>
                                    <li><em>Oficial de infantería y disparos festivos:</em> la ética profesional no se apaga fuera de servicio.</li>
                                    <li><em>Supervisor y “detalle” del contratista:</em> transparencia ante regalos monetarios.</li>
                                    <li><em>Exceso de confianza en recepción de combustible:</em> la experiencia sin verificación es temeridad.</li>
                                    <li><em>Falla menor no reportada (dilema):</em> seguridad vs. presión comercial.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- Lecture 02: Filosofía Clásica (Sócrates, Aristóteles, Kant) -->
                    <div class="accordion-item shadow-sm mb-3 border-0">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#l2" onclick="markAsRead(1)">
                                <i id="icon-l1" class="bi bi-circle read-status-icon status-pending"></i> Lecture 02: Trípode Filosófico – Sócrates, Aristóteles, Kant
                            </button>
                        </h2>
                        <div id="l2" class="accordion-collapse collapse" data-bs-parent="#lecturesAccordion">
                            <div class="accordion-body">
                                <h5 class="text-primary">Sócrates: intelectualismo moral</h5>
                                <p>Conocer el bien es suficiente para obrar bien. El mal es ignorancia. El conocimiento técnico debe ir unido a la virtud.</p>
                                <h5 class="text-primary">Aristóteles: justo medio y prudencia</h5>
                                <p><em>Mesótes:</em> virtud = equilibrio entre exceso y defecto. <em>Phronesis:</em> sabiduría práctica para aplicar el justo medio según contexto.</p>
                                <h5 class="text-primary">Kant: imperativo categórico y deber</h5>
                                <p>Actúa según máximas que puedan ser ley universal. Las personas son fines, no medios. Actuar por deber, no por conveniencia.</p>
                                <h5 class="text-primary mt-3">Confianza acrítica vs. carácter forjado</h5>
                                <p>La experiencia sin autocrítica genera exceso de confianza (sesgo). El carácter se construye con hábitos reflexivos.</p>
                                <h5 class="text-primary mt-3">Casos</h5>
                                <ul>
                                    <li><em>Capitán y exceso de confianza:</em> ignorar procedimientos por arrogancia.</li>
                                    <li><em>Presión comercial vs. seguridad:</em> el justo medio: velocidad moderada con vigilancia.</li>
                                    <li><em>Dilema del reporte (Kant):</em> ocultar una falla no es universalizable.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- Lecture 03: Sistema Moral y Conciencia Ética -->
                    <div class="accordion-item shadow-sm mb-3 border-0">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed fw-bold" type="button" data-bs-toggle="collapse" data-bs-target="#l3" onclick="markAsRead(2)">
                                <i id="icon-l2" class="bi bi-circle read-status-icon status-pending"></i> Lecture 03: Sistema Moral, Conciencia y Decisiones a Bordo
                            </button>
                        </h2>
                        <div id="l3" class="accordion-collapse collapse" data-bs-parent="#lecturesAccordion">
                            <div class="accordion-body">
                                <h5 class="text-primary">Moral (sistema operativo) vs. Ética (reflexión crítica)</h5>
                                <p>La moral se interioriza desde la familia; la ética la examina y la aplica profesionalmente.</p>
                                <h5 class="text-primary">Conciencia ética</h5>
                                <p>Comprensión profunda del <em>por qué</em> de las normas. Permite actuar con responsabilidad sin supervisión.</p>
                                <h5 class="text-primary">Lealtad vs. Responsabilidad</h5>
                                <p>El dilema del marino: la verdadera lealtad es al cargo y la seguridad, no encubrir errores.</p>
                                <h5 class="text-primary">Autoridad STOP</h5>
                                <p>Cualquier tripulante puede detener una maniobra insegura. Cultura justa: quien para es respaldado.</p>
                                <h5 class="text-primary mt-3">Casos reales</h5>
                                <ul>
                                    <li><em>Motor emulsionado (Camilo):</em> complacencia y no reportar pone en riesgo el buque.</li>
                                    <li><em>Derrame de aceite (Sergio Usma):</em> decidir como cargo, no por empatía personal.</li>
                                    <li><em>Tolerancia con criterio:</em> adaptarse a culturas sin ceder en seguridad.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PESTAÑA DE FLASHCARDS (todas en forma de pregunta) -->
            <div class="tab-pane fade" id="flashcards">
                <div class="flashcard-container" id="fc-container" onclick="this.querySelector('.card-flip').classList.toggle('is-flipped')">
                    <div class="card-flip" id="fc-flip">
                        <div class="card-face card-front shadow"><h3 id="fc-front">¿Cargando...?</h3></div>
                        <div class="card-face card-back shadow"><p id="fc-back" class="fs-4"></p></div>
                    </div>
                </div>
                <div class="d-flex justify-content-center mt-4 gap-3 align-items-center">
                    <button class="btn btn-outline-primary" onclick="changeFC(-1)"><i class="bi bi-chevron-left"></i></button>
                    <span id="fc-counter" class="fw-bold">1 / 25</span>
                    <button class="btn btn-outline-primary" onclick="changeFC(1)"><i class="bi bi-chevron-right"></i></button>
                </div>
            </div>

            <!-- PESTAÑA DE QUIZ (preguntas autocontenidas) -->
            <div class="tab-pane fade" id="quiz">
                <div class="card border-0 shadow-sm p-4">
                    <div class="d-flex justify-content-between mb-3">
                        <h4 id="quiz-q-title" class="text-primary">Pregunta</h4>
                        <span id="quiz-prog" class="badge bg-secondary">1/15</span>
                    </div>
                    <p id="quiz-question" class="fs-5 fw-bold"></p>
                    <div id="quiz-options"></div>
                    <div id="quiz-exp" class="explanation-box rounded"></div>
                    <button id="btn-next-q" class="btn btn-primary mt-3 d-none" onclick="nextQuestion()">Siguiente <i class="bi bi-arrow-right"></i></button>
                </div>
            </div>

            <!-- PESTAÑA DE RESUMEN (bloques de texto simples) -->
            <div class="tab-pane fade" id="summary">
                <div id="summary-cont" class="d-flex flex-column gap-3"></div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2026 Academia Marítima - Sistema de Aprendizaje Activo</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // --------------------------------------------------------------
        // DATOS DEL MÓDULO – Versión final con correcciones:
        // - Flashcards todas en forma de pregunta.
        // - Quiz autocontenido, sin referencias a nombres sin contexto, enfocado en ética marítima.
        // - Resumen con estilo propio (sin alerts).
        // --------------------------------------------------------------

        const data = {
            flashcards: [
                { f: "¿Qué distingue a la ética de la moral?", b: "Ética: reflexión crítica universal; Moral: costumbres locales y subjetivas." },
                { f: "¿Qué significa el término griego 'ethos'?", b: "Carácter, modo de ser; credibilidad moral del profesional." },
                { f: "¿En qué consiste la habituación reflexiva?", b: "Formación del carácter mediante repetición consciente de actos éticos." },
                { f: "Según Sócrates, ¿qué es el intelectualismo moral?", b: "Doctrina que afirma que conocer el bien es suficiente para obrar bien; el mal es ignorancia." },
                { f: "¿Qué es la phronesis en la ética aristotélica?", b: "Sabiduría práctica para deliberar sobre el justo medio." },
                { f: "¿Qué significa el justo medio (mesótes) según Aristóteles?", b: "Equilibrio virtuoso entre dos extremos viciosos (exceso y defecto)." },
                { f: "¿En qué consiste el imperativo categórico de Kant?", b: "Obra según la máxima que puedas querer que se convierta en ley universal." },
                { f: "¿Qué significa 'actuar por deber' en la ética kantiana?", b: "Realizar una acción porque es moralmente correcta, no por conveniencia o recompensa." },
                { f: "¿Qué es la autoridad STOP a bordo de un buque?", b: "Derecho de cualquier tripulante a detener una maniobra insegura." },
                { f: "¿Qué es la conciencia ética?", b: "Conocimiento profundo que lleva a actuar responsablemente incluso sin supervisión." },
                { f: "¿Cómo se diferencia la lealtad mal entendida de la lealtad al cargo?", b: "La lealtad verdadera es al cargo y la seguridad, no encubrir errores." },
                { f: "¿Qué es la confianza acrítica?", b: "Sesgo por el que la experiencia genera exceso de confianza e ignorar procedimientos." },
                { f: "¿Qué significa trazabilidad en el contexto ético marítimo?", b: "Documentar decisiones (fecha, lugar, fundamentos) para auditorías." },
                { f: "¿Qué es la inteligencia cultural (CQ)?", b: "Capacidad de relacionarse en contextos diversos respetando principios universales." },
                { f: "¿Qué es la complacencia o normalización en seguridad?", b: "Tendencia a aceptar desviaciones por repetición, erosionando la seguridad." },
                { f: "¿Qué es un near-miss y por qué es importante reportarlo?", b: "Incidente con potencial de daño; su reporte es clave para prevenir." },
                { f: "¿Qué es una cultura justa (just culture)?", b: "Equilibra rendición de cuentas y aprendizaje (error vs negligencia)." },
                { f: "Según Aristóteles, ¿qué principio debe aplicarse ante presión comercial?", b: "La prudencia (phronesis) para hallar el justo medio entre temeridad y pasividad." },
                { f: "¿Qué es la deontología?", b: "Enfoque ético basado en deberes y reglas (códigos ISM, SOLAS)." },
                { f: "¿Qué es el consecuencialismo?", b: "Enfoque que pondera resultados y daños potenciales de una decisión." },
                { f: "¿Qué significa 'tolerancia con criterio' en tripulaciones multiculturales?", b: "Aceptar diferencias culturales sin vulnerar estándares éticos de seguridad y dignidad." },
                { f: "¿Qué es un conflicto de interés?", b: "Situación donde el juicio profesional puede estar influenciado por intereses secundarios." },
                { f: "¿Por qué la corrupción es considerada un fallo sistémico?", b: "No solo soborno; incluye negligencia, ausentismo, incumplimiento." },
                { f: "Según Sócrates, ¿cuál es la causa del mal moral?", b: "La ignorancia (amathia)." },
                { f: "¿Qué es la eudaimonia para Aristóteles?", b: "Florecimiento humano o vida lograda, fin último de la ética." }
            ],
            quiz: [
                {
                    q: "Un oficial mercante, durante su tiempo libre en puerto, participa en una riña menor sin consecuencias legales graves. ¿Cuál es el principal problema ético?",
                    o: [
                        "No hay problema porque fue en tiempo libre.",
                        "Daña la reputación de la institución y la confianza pública.",
                        "Solo es relevante si fue detenido.",
                        "Es un asunto personal sin relación con su profesión."
                    ],
                    c: 1,
                    e: "Correcto. El oficial siempre representa a su institución y a la profesión, incluso fuera de servicio; la confianza pública se erosiona con conductas inapropiadas."
                },
                {
                    q: "Un inspector de seguridad recibe un pequeño obsequio de un contratista después de una inspección favorable. ¿Cuál es la acción éticamente adecuada?",
                    o: [
                        "Aceptarlo como gesto de cortesía.",
                        "Reportar el incidente y rechazar cualquier obsequio de valor.",
                        "Aceptarlo solo si es de bajo valor.",
                        "Devolverlo discretamente sin informar."
                    ],
                    c: 1,
                    e: "La transparencia y evitar conflictos de interés son fundamentales. Se debe reportar y establecer una política clara de no aceptar regalos."
                },
                {
                    q: "Según Aristóteles, ¿cómo debe actuar un capitán ante presión comercial por mantener la velocidad en condiciones climáticas adversas?",
                    o: [
                        "Priorizar la velocidad para cumplir el cronograma.",
                        "Reducir velocidad drásticamente por precaución extrema.",
                        "Buscar un equilibrio: velocidad moderada con vigilancia reforzada.",
                        "Seguir la orden de la naviera sin cuestionar."
                    ],
                    c: 2,
                    e: "Aristóteles propone el justo medio: ni temeridad (exceso) ni cobardía (defecto). La prudencia (phronesis) permite ajustarse al contexto."
                },
                {
                    q: "Un capitán detecta una falla menor en un equipo de seguridad que debe ser reportada, pero la naviera le sugiere no hacerlo para evitar retrasos. Aplicando el imperativo categórico de Kant, ¿qué debe hacer?",
                    o: [
                        "No reportar para ser leal a la empresa.",
                        "Reportar porque si todos ocultaran fallas, el sistema colapsaría.",
                        "Reportar solo si la falla empeora.",
                        "Consultar con la tripulación y decidir por mayoría."
                    ],
                    c: 1,
                    e: "Kant diría: obra según la máxima que puedas universalizar. Ocultar fallas no puede ser ley universal sin destruir la seguridad marítima."
                },
                {
                    q: "Un oficial con años de experiencia decide no seguir un procedimiento de seguridad porque 'siempre lo ha hecho así y nunca ha pasado nada'. ¿Qué concepto explica este comportamiento?",
                    o: [
                        "Intelectualismo moral.",
                        "Confianza acrítica.",
                        "Phronesis.",
                        "Deontología."
                    ],
                    c: 1,
                    e: "Confianza acrítica: la experiencia previa exitosa genera exceso de confianza y lleva a ignorar procedimientos, aumentando el riesgo."
                },
                {
                    q: "Un maquinista detecta una pequeña fuga de aceite pero no la reporta para evitar papeleo. ¿Cuál es el problema ético principal?",
                    o: [
                        "Es solo un problema técnico, no ético.",
                        "La omisión de reportar puede tener consecuencias ambientales y de seguridad graves.",
                        "Si la fuga es muy pequeña, no hay problema.",
                        "El problema es solo si alguien se entera."
                    ],
                    c: 1,
                    e: "La omisión consciente de reportar una falla, por pequeña que sea, es una falta ética porque vulnera la responsabilidad con el medio ambiente y la seguridad."
                },
                {
                    q: "¿Qué significa la autoridad STOP a bordo de un buque mercante?",
                    o: [
                        "Solo el capitán puede detener una maniobra.",
                        "Cualquier tripulante puede detener una maniobra si percibe riesgo.",
                        "Es una orden para detener la máquina.",
                        "Solo aplica en emergencias declaradas."
                    ],
                    c: 1,
                    e: "Es un derecho universal: cualquier persona a bordo puede y debe detener una operación insegura, independientemente del rango."
                },
                {
                    q: "Según el material de estudio, ¿cuál es la diferencia fundamental entre ética y moral?",
                    o: [
                        "Son sinónimos.",
                        "La ética es reflexión crítica universal; la moral son costumbres locales.",
                        "La moral es reflexión; la ética son costumbres.",
                        "La ética se aplica en el trabajo; la moral en la casa."
                    ],
                    c: 1,
                    e: "La ética examina racionalmente la moral (normas culturales) y busca principios universales, mientras que la moral es el conjunto de costumbres de una comunidad."
                },
                {
                    q: "Un inspector presencia un derrame menor de aceite causado por un daño no reportado. El capitán le ruega que no informe. ¿Qué debe hacer el inspector?",
                    o: [
                        "No reportar por empatía hacia el capitán.",
                        "Reportar porque su deber legal y ético prevalece sobre la compasión personal.",
                        "Reportar solo si el derrame es significativo.",
                        "Sugerir al capitán que lo limpie y no decir nada."
                    ],
                    c: 1,
                    e: "El inspector actúa como representante de la autoridad; debe priorizar su deber (MARPOL) y la protección ambiental sobre la empatía personal."
                },
                {
                    q: "¿Qué es la habituación reflexiva en la formación ética?",
                    o: [
                        "Repetir actos sin pensar.",
                        "Formar el carácter mediante repetición consciente y análisis de las acciones.",
                        "Seguir las costumbres del entorno.",
                        "Aprender de memoria los códigos de conducta."
                    ],
                    c: 1,
                    e: "Es la repetición de actos éticos acompañada de reflexión sobre sus fundamentos, forjando así el carácter moral del profesional."
                },
                {
                    q: "¿Cuál de las siguientes situaciones ejemplifica una 'zona gris' ética en el ámbito marítimo?",
                    o: [
                        "Descargar petróleo al mar violando MARPOL.",
                        "No reportar una falla menor que no es obligatoria según la ley, pero podría afectar la seguridad a largo plazo.",
                        "Robar en un puerto.",
                        "Agredir a un subordinado."
                    ],
                    c: 1,
                    e: "Las zonas grises surgen cuando la ley no es explícita o hay conflicto entre legalidad y responsabilidad ética, como en este caso."
                },
                {
                    q: "Según Sócrates, si un oficial mercante conoce la norma pero actúa mal, ¿cuál es la causa?",
                    o: [
                        "Tiene mal carácter.",
                        "Su conocimiento no es verdadero; es ignorancia.",
                        "La norma es incorrecta.",
                        "Actúa por debilidad de la voluntad."
                    ],
                    c: 1,
                    e: "Sócrates sostiene que nadie obra mal a sabiendas; si actúa mal, es porque en realidad no conoce el bien (ignorancia)."
                },
                {
                    q: "¿Qué papel juega la familia en la formación ética según el material de estudio?",
                    o: [
                        "Es irrelevante para la ética profesional.",
                        "Proporciona los primeros valores morales que luego serán reflexionados éticamente.",
                        "Enseña las normas técnicas de la profesión.",
                        "Solo influye en la moral personal, no en la ética."
                    ],
                    c: 1,
                    e: "La familia es el primer entorno donde se interiorizan valores (moral), base sobre la que luego se construye la reflexión ética profesional."
                },
                {
                    q: "¿Qué es la phronesis y por qué es crucial para un oficial mercante?",
                    o: [
                        "Conocimiento técnico de los equipos.",
                        "Virtud ética innata.",
                        "Sabiduría práctica para deliberar y decidir correctamente en situaciones complejas.",
                        "Cumplimiento estricto de reglas."
                    ],
                    c: 2,
                    e: "Phronesis es la prudencia o inteligencia práctica que permite aplicar principios éticos a contextos cambiantes, esencial para el liderazgo a bordo."
                },
                {
                    q: "¿Cuál es la principal consecuencia de la complacencia en la cultura de seguridad de un buque?",
                    o: [
                        "Aumenta la moral de la tripulación.",
                        "Normaliza las desviaciones de los procedimientos, incrementando el riesgo de accidentes.",
                        "Mejora la eficiencia operativa.",
                        "Reduce los conflictos entre oficiales."
                    ],
                    c: 1,
                    e: "La complacencia lleva a aceptar pequeñas desviaciones como 'normales', erosionando la seguridad y preparando el terreno para incidentes graves."
                }
            ],
            summary: [
                "La ética es el 'sistema de seguridad moral' que guía decisiones en presión, complementando la técnica.",
                "El carácter profesional se forja mediante habituación reflexiva (repetición consciente).",
                "Sócrates: el conocimiento lleva a la virtud; ignorancia es la raíz del mal.",
                "Aristóteles: la prudencia (phronesis) permite hallar el justo medio en contextos cambiantes.",
                "Kant: actuar por deber, como si nuestra acción fuera ley universal; las personas son fines, nunca medios.",
                "Autoridad STOP: cualquier tripulante puede detener una maniobra insegura – la seguridad prima sobre la jerarquía.",
                "Lealtad verdadera es al cargo y la seguridad, no encubrir errores de compañeros.",
                "Conciencia ética = comprender el 'por qué' de las normas, actuar sin supervisión.",
                "Cultura justa: distingue error honesto (aprender) de negligencia (sancionar).",
                "La corrupción no es solo soborno; incluye negligencia, ausentismo y falta de reporte."
            ]
        };

        // Variables de estado
        let curFC = 0;
        let curQ = 0;
        let readLectures = new Set();      // índices 0,1,2
        let doneFC = new Set();            // flashcards vistos
        let doneQ = new Set();             // preguntas de quiz respondidas correctamente

        function init() {
            renderFC();
            renderQ();
            updateProg();

            // Cargar resumen con estilo personalizado
            const sCont = document.getElementById('summary-cont');
            data.summary.forEach(text => {
                const div = document.createElement('div');
                div.className = 'summary-item';
                div.innerHTML = `<i class="bi bi-info-circle-fill me-2 text-secondary"></i>${text}`;
                sCont.appendChild(div);
            });
        }

        // Marcar lectura como leída (llamado desde onclick del acordeón)
        function markAsRead(idx) {
            readLectures.add(idx);
            const icon = document.getElementById(`icon-l${idx}`);
            icon.classList.replace('bi-circle', 'bi-check-circle-fill');
            icon.classList.replace('status-pending', 'status-completed');
            updateProg();
        }

        // Actualizar barra de progreso global
        function updateProg() {
            const total = 3 + data.flashcards.length + data.quiz.length; // lecturas + flashcards + quiz
            const current = readLectures.size + doneFC.size + doneQ.size;
            const perc = Math.round((current / total) * 100);

            document.getElementById('global-progress').style.width = perc + "%";
            document.getElementById('progress-text').textContent = `${current} / ${total} hitos completados`;
            const badge = document.getElementById('progress-badge');
            badge.textContent = `${perc}% Completado`;
            if (perc === 100) {
                badge.className = "badge bg-success rounded-pill px-3 py-2";
            } else {
                badge.className = "badge bg-warning text-dark rounded-pill px-3 py-2";
            }
        }

        // Flashcards
        function renderFC() {
            document.getElementById('fc-flip').classList.remove('is-flipped');
            document.getElementById('fc-front').textContent = data.flashcards[curFC].f;
            document.getElementById('fc-back').textContent = data.flashcards[curFC].b;
            document.getElementById('fc-counter').textContent = `${curFC + 1} / ${data.flashcards.length}`;
            doneFC.add(curFC);
            updateProg();
        }

        function changeFC(dir) {
            curFC = (curFC + dir + data.flashcards.length) % data.flashcards.length;
            renderFC();
        }

        // Quiz
        function renderQ() {
            const q = data.quiz[curQ];
            document.getElementById('quiz-question').textContent = q.q;
            document.getElementById('quiz-prog').textContent = `${curQ+1} / ${data.quiz.length}`;
            const optCont = document.getElementById('quiz-options');
            optCont.innerHTML = "";
            document.getElementById('quiz-exp').style.display = 'none';
            document.getElementById('btn-next-q').classList.add('d-none');

            q.o.forEach((o, i) => {
                const btn = document.createElement('button');
                btn.className = "quiz-option btn text-start mb-2 d-block w-100";
                btn.textContent = o;
                btn.onclick = () => {
                    // Deshabilitar todas las opciones tras responder
                    document.querySelectorAll('.quiz-option').forEach(b => b.disabled = true);
                    if (i === q.c) {
                        btn.classList.add('correct');
                        doneQ.add(curQ);
                    } else {
                        btn.classList.add('incorrect');
                    }
                    document.getElementById('quiz-exp').textContent = q.e;
                    document.getElementById('quiz-exp').style.display = 'block';
                    document.getElementById('btn-next-q').classList.remove('d-none');
                    updateProg();
                };
                optCont.appendChild(btn);
            });
        }

        function nextQuestion() {
            curQ = (curQ + 1) % data.quiz.length;
            renderQ();
        }

        // Exponer funciones globales para los onclick del HTML
        window.markAsRead = markAsRead;
        window.changeFC = changeFC;
        window.nextQuestion = nextQuestion;

        window.onload = init;
    </script>
</body>
</html>